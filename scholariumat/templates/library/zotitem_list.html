{% extends "base.html" %}
{% load sorting_tags %}
{% load semanticui %}
{% autosort zotitems %}

{% block title %}Bibliothek{% endblock %}

{% block content %}
<h1 class="ui huge center aligned header">Bibliothek</h1>
<div class="ui hidden section divider"></div>

<div class="ui center aligned container">
  <form class="ui form">
    <div class="ui action input">
      <input name="search" placeholder="Suche..." type="text">
      <button class="ui icon button" type="submit">
        <i class="search icon"></i>
      </button>
    </div>
  </form>
</div>


{% if collection %}
<div class="ui header">
  <div class="ui huge breadcrumb">
    {% for parent in parents %}
    <a class="section" href="{% url 'library:collection' parent.slug %}">{{ parent }}</a>
    <i class="right chevron icon divider"></i>
    {% endfor %}
    <div class="active section">{{ collection }}</div>
  </div>
</div>
{% elif 'search' in request.GET %}
  <h2>Suche: {{ request.GET.search }}</h2>
{% endif %}

{% if children %}
  <h3 class="ui small header">Kollektionen</h3>
  <div class="ui compact menu">
  {% for child in children %}
    <a class="teal item" href="{% url 'library:collection' child.slug %}">
      {{ child }}
      <div class="ui label">{{ child.zotitem_set.all|length }}</div>
    </a>
  {% endfor %}
</div>
{% endif %}

{% if zotitems %}
  <h3 class="ui small header">Werke</h3>
<table class="ui table">
  <thead>
    <tr>
      <th>{% anchor title "Titel" %}</th>
      <th>{% anchor authors "Autor" %}</th>
      <th>{% anchor published "Jahr" %}</th>
      <th>Verf√ºgbarkeit</th>
    </tr>
  </thead>
  <tbody>
    {% for zotitem in zotitems %}
    <tr>
      <td>
        <a href={% url 'library:zot_item' zotitem.slug %}>{{ zotitem.title }}</a>
      </td>
      <td>
        {% for author in zotitem.authors.all %}
          <a href="{% url 'library:list' %}?search={{ author.name }}">{{ author.name }}</a><br>
        {% endfor %}
      </td>
      <td>
        {% if zotitem.published %}
          {{ zotitem.published.year }}
        {% endif %}
      </td>
      <td>
        <ul>
        {% for item in zotitem.product.item_set.all %}
          <li>{{ item }}</li>
        {% endfor %}
        </ul>
      </td>
    </tr>
    {% endfor %}
  </tbody>
  
  <tfoot>
    <tr>
      <th colspan="4">
        <div class="ui right floated pagination menu">
        {#% include "components/pagination.html" %#}
          <a class="icon item">
            <i class="left chevron icon"></i>
          </a>
          <a class="item">1</a>
          <a class="item">2</a>
          <a class="item">3</a>
          <a class="item">4</a>
          <a class="icon item">
            <i class="right chevron icon"></i>
          </a>
        </div>
      </th>
    </tr>
  </tfoot>
</table>
{% endif %}

{% endblock content %}
